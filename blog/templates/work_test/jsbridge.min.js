(this.nativeLog||function(t){console.log(t)})("START JS BRIDGE 1.0.2, Build 2021-04-20 17:40. ");var process={env:{}},global=this,setTimeout=global.setTimeout;!function(t){("object"!=typeof exports||"undefined"==typeof module)&&"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";var n={framework:"1.0.2",transformer:">=0.1.5 <0.5"};function i(t){t=Object.prototype.toString.call(t);return t.substring(8,t.length-1)}function o(t){return"[object Object]"===Object.prototype.toString.call(t)}function l(t){if("function"!=typeof btoa)return"";t=Array.prototype.map.call(new Uint8Array(t),function(t){return String.fromCharCode(t)}).join("");return btoa(t)}var a={};function e(t,e){return"string"==typeof e?!(!a[t]||!a[t][e]):!!a[t]}function t(t){this.instanceId=String(t),this.lastCallbackId=0,this.callbacks={},this.hooks={}}t.prototype.add=function(t){return this.lastCallbackId++,this.callbacks[this.lastCallbackId]=t,this.lastCallbackId},t.prototype.remove=function(t){var e=this.callbacks[t];return delete this.callbacks[t],e},t.prototype.consume=function(t,e,n){var r=this.callbacks[t];if(void 0!==n&&!1!==n||delete this.callbacks[t],"function"==typeof r)try{return r.call(null,e)}catch(t){throw console.error("[JS Framework] Failed to execute the callback function:\n "+t.toString()),t}return new Error('invalid callback id "'+t+'"')},t.prototype.close=function(){this.callbacks={}};function r(){Object.defineProperty(this,"callbackManager",{enumerable:!0,value:new t})}var c=navigator.userAgent;r.prototype.isAndroid=function(){return global.isAndroid||(global.isAndroid=-1<c.indexOf("Android")||-1<c.indexOf("Linux"),global.isAndroid)},r.prototype.isIOS=function(){return!!/iphone|ipad|ipod/i.test(c)},r.prototype.normalize=function(t,e){var n=this;void 0===e&&(e=!1);var r=i(t);if("Function"===r)return this.callbackManager.add(t).toString();if(e){if("Object"===r){var o,a={};for(o in t)a[o]=n.normalize(t[o],!0);return a}if("Array"===r)return t.map(function(t){return n.normalize(t,!0)})}return function(t){var e=i(t);switch(e){case"Undefined":case"Null":return"";case"RegExp":return t.toString();case"Date":return t.toISOString();case"Number":case"String":case"Boolean":case"Array":case"Object":return t;case"ArrayBuffer":return{"@type":"binary",dataType:e,base64:l(t)};case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":return{"@type":"binary",dataType:e,base64:l(t.buffer)};default:return JSON.stringify(t)}}(t)},r.prototype.callBack=function(t,e,n){return this.callbackManager.consume(t,e,n)},r.prototype.callNative=function(t,e,n){var r=this,o=(t.action,t.module),a=t.method;e=e.map(function(t){return r.normalize(t)}),"Object"===i(n)&&(n=this.normalize(n,!0)),t="[callNative]("+o+","+a+") "+JSON.stringify(e),console.log("jsfm:"+t);n={module:o,method:a,args:e,options:n};if(this.isAndroid()){if(window.MSNative.callNativeModule)return window.MSNative.callNativeModule(JSON.stringify(n));console.log("No native callNativeModule function defined!")}else{if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.callNativeModule)return window.webkit.messageHandlers.callNativeModule.postMessage(n);console.log("No native callNativeModule function defined!")}},r.prototype.callEngineStartup=function(){if(this.isAndroid()){if(window.MSNative.callEngineStartup)return window.MSNative.callEngineStartup();console.log("No native callEngineStartup function defined!")}else{if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.callEngineStartup)return window.webkit.messageHandlers.callEngineStartup.postMessage(null);console.log("No native callEngineStartup function defined!")}};var s=new r;function u(t,e,n){return s.callBack(t,e,n)}var f={getJSFMVersion:function(){return"1.0.2"},registerModules:function(r){function t(e){var t,n;n=e,o(t=a)&&Object.prototype.hasOwnProperty.call(t,n)||(a[e]={}),Array.isArray(r[e])&&r[e].forEach(function(t){"string"==typeof t?a[e][t]=!0:o(t)&&"string"==typeof t.name&&(a[e][t.name]=t.args||[])})}for(var e in void 0===r&&(r={}),r)t(e)},callJS:function(t){return t=t,Array.isArray(t)?t.map(function(t){if("callback"===t.method)return u.apply(void 0,[t.funcId].concat(t.args))}):"callback"===t.method?u.apply(void 0,[t.funcId].concat(t.args)):void 0}};function d(){this.requireModule=this.requireModule.bind(this),this.isRegisteredModule=e}d.prototype.requireModule=function(o){var e;return(e={get:function(t,e){var n,r;t()&&t()[e];return n=o,r=e,function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return s.callNative({module:n,method:r},t)}},apply:function(t,e,n){return t()}},function(t){return new Proxy(function(){return t},e)})({})},d.prototype.supports=function(t){if("string"!=typeof t)return null;t=t.match(/^@(\w+)\/([\w-]+)(\.(\w+))?$/i);return t?e(t[1],t[2]):null},function(){var t=n.native;global.frameworkVersion=t,global.native=new d;var e,i=f;for(e in i)!function(a){global[a]=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=i[a].apply(i,t);if(Array.isArray(n))for(var r=0,o=n.length;r<o;r++)n[r]instanceof Error&&console.error(n.toString());else n instanceof Error&&console.error(n.toString());return n}}(e)}(window)});
//# sourceMappingURL=jsbridge.min.js.map
